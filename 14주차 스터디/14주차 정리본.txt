# 14ì£¼ì°¨ ìŠ¤í„°ë””

# 16ì¥ ë¦¬ë•ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´í•´í•˜ê¸°

## 16.1 ê°œë… ë¯¸ë¦¬ ì •ë¦¬í•˜ê¸°

### 16.1.1 ì•¡ì…˜

ì•¡ì…˜ì€ í•˜ë‚˜ì˜ ê°ì²´ë¡œ í‘œí˜„ëœë‹¤.

```jsx
{
  type: 'TOGGLE_VALUE'
}
```

ì•¡ì…˜ ê°ì²´: type í•„ë“œ í•„ìˆ˜! (ì•¡ì…˜ì˜ ì´ë¦„)

### 16.1.2 ì•¡ì…˜ ìƒì„± í•¨ìˆ˜

***ì•¡ì…˜ ìƒì„± í•¨ìˆ˜***

- ì•¡ì…˜ ê°ì²´ë¥¼ ë§Œë“¤ì–´ ì£¼ëŠ” í•¨ìˆ˜

```jsx
function addTodo(data) {
return {
    type: 'ADD_TODO',
  data
};
}

// í™”ì‚´í‘œ í•¨ìˆ˜ë¡œë„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
const changeInput = text => ({
  type: 'CHANGE_INPUT',
text
});
```

### 16.1.3 ë¦¬ë“€ì„œ

***ë¦¬ë“€ì„œ***

- ë³€í™”ë¥¼ ì¼ìœ¼í‚¤ëŠ” í•¨ìˆ˜

```jsx
const initialState = {
  counter: 1
};
function reducer(state = initialState, action) {
switch (action.type) {
  case INCREMENT:
    return {
        counter: state.counter + 1
    };
  default:
    return state;
}
}
```

### 16.1.4 ìŠ¤í† ì–´

***ìŠ¤í† ì–´***

- í”„ë¡œì íŠ¸ì— ë¦¬ë•ìŠ¤ë¥¼ ì ìš©í•˜ê¸° ìœ„í•œ ê²ƒ
- ì–´í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ, ë¦¬ë“€ì„œ (+ ì¤‘ìš”í•œ ë‚´ì¥ í•¨ìˆ˜)

### 16.1.5 ë””ìŠ¤íŒ¨ì¹˜

***ë””ìŠ¤íŒ¨ì¹˜***

- ìŠ¤í† ì–´ ë‚´ì¥ í•¨ìˆ˜
- ì•¡ì…˜ì„ ë°œìƒ ì‹œí‚¤ëŠ” ê²ƒ
- ì•¡ì…˜ ê°ì²´ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„£ì–´ì„œ í˜¸ì¶œí•œë‹¤.
- í˜¸ì¶œë˜ë©´ ìŠ¤í† ì–´ëŠ” ë¦¬ë“€ì„œ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œì¼œì„œ ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë§Œë“ ë‹¤.

### 16.1.6 êµ¬ë…

***êµ¬ë…***

- ìŠ¤í† ì–´ ë‚´ì¥ í•¨ìˆ˜

```jsx
const listener = () => {
console.log('ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë¨');
}
const unsubscribe = store.subscribe(listener);

unsubscribe(); // ì¶”í›„ êµ¬ë…ì„ ë¹„í™œì„±í™”í•  ë•Œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œ
```

êµ¬ë… í•¨ìˆ˜ ì•ˆì— ë¦¬ìŠ¤ë„ˆ í•¨ìˆ˜ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„£ì–´ì„œ í˜¸ì¶œí•œë‹¤.

â†’ ë¦¬ìŠ¤ë„ˆ í•¨ìˆ˜ê°€ ì•¡ì…˜ì´ ë””ìŠ¤íŒ¨ì¹˜ë˜ì–´ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë  ë•Œë§ˆë‹¤ í˜¸ì¶œëœë‹¤.

## **16.2Â ë¦¬ì•¡íŠ¸ ì—†ì´ ì“°ëŠ” ë¦¬ë•ìŠ¤**

***ë¦¬ë•ìŠ¤*** 

- ë‹¤ë¥¸ UI ë¼ì´ë¸ŒëŸ¬ë¦¬/í”„ë ˆì„ì›Œí¬ì™€ í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥
- ë°”ë‹ë¼ JSì™€ í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥

***ë°”ë‹ë¼ JS***

- ë¼ì´ë¸ŒëŸ¬ë¦¬, í”„ë ˆì„ì›Œí¬ ì—†ì´ ì‚¬ìš©í•˜ëŠ” ìˆœìˆ˜ JS

### 16.2.1 Parcelë¡œ í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°

**ì„¤ì¹˜ ë°©ë²•**

`$ yarn global add parcel-bundler`

â†’ ì´ê±° ì˜ ì•ˆë˜ë‹ˆê¹Œ

`$ npm install -g parcel-bundler`

â†’ ì´ê±¸ë¡œ í•˜ì!

`$ mkdir vanilla-redux`

`$ cd vanilla-redux`

`$ yarn init -y` 

â†’ package.json íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤ìš”~

```jsx
<html>
  <body>
    <div>ë°”ë‹ë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸</div>
    <script src="./index.js"></script>
  </body>
</html>
```

```jsx
console.log('hello parcel');
```

`$ parcel index.html` 

â†’ ì„œë²„ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤!

`$ yarn add redux`

â†’ ë¦¬ë•ìŠ¤ ëª¨ë“ˆ ì„¤ì¹˜

### 16.2.2 ê°„ë‹¨í•œ UI êµ¬ì„±í•˜ê¸°

```css
.toggle {
  border: 2px solid black;
  width: 64px;
  height: 64px;
  border-radius: 32px;
  box-sizing: border-box;
}

.toggle.active {
  background: yellow;
}
```

```jsx
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="index.css" />
  </head>
  <body>
    <div class="toggle"></div>
    <hr />
    <h1>0</h1>
    <button id="increase">+1</button>
    <button id="decrease">-1</button>
    <script src="./index.js"></script>
  </body>
</html>
```

### 16.2.3 DOM ë ˆí¼ëŸ°ìŠ¤ ë§Œë“¤ê¸°

ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì—†ì–´ì„œ DOMì„ ì§ì ‘ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

```jsx
const divToggle = document.querySelector('.toggle');
const counter = document.querySelector('h1');
const btnIncrease = document.querySelector('#increase');
const btnDecrease = document.querySelector('#decrease');
```

### 16.2.4 ì•¡ì…˜ íƒ€ì…ê³¼ ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ ì •ì˜

***ì•¡ì…˜, í”„ë¡œì íŠ¸ ìƒíƒœì— ë³€í™”ë¥¼ ì¼ìœ¼í‚¤ëŠ” ê²ƒ***

- ì•¡ì…˜ ì´ë¦„ì€ ë¬¸ìì—´, ëŒ€ë¬¸ì, ê³ ìœ ì„±, ì¤‘ë³µX

```jsx
const TOGGLE_SWITCH = 'TOGGLE_SWITCH';
const INCREASE = 'INCREASE';
const DECREASE = 'DECREASE';
```

- ì•¡ì…˜ ê°ì²´ëŠ” type ê°’ì´ í•„ìš”í•˜ë‹¤.
- ì´ ì•¡ì…˜ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ì•¡ì…˜ ê°ì²´ë¥¼ ë§Œë“œëŠ” ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ë¥¼ ë§Œë“¤ê¸°

```jsx
const toggleSwitch = () => ({ type: TOGGLE_SWITCH });
const increase = difference => ({ type: INCREASE, difference });
const decrease = () => ({ type: DECREASE });
```

### 16.2.5 ì´ˆê¹ƒê°’ ì„¤ì •

```jsx
const initialState = {
  toggle: false,
  counter: 0
};
```

### 16.2.6 ë¦¬ë“€ì„œ í•¨ìˆ˜ ì •ì˜

***ë¦¬ë“€ì„œ, ë³€í™”ë¥¼ ì¼ìœ¼í‚¤ëŠ” í•¨ìˆ˜***

- í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°: state, action

```jsx
// stateê°€ undefinedì¼ ë•ŒëŠ” initialStateë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©
function reducer(state = initialState, action) {
  // action.typeì— ë”°ë¼ ë‹¤ë¥¸ ì‘ì—…ì„ ì²˜ë¦¬í•¨
  switch (action.type) {
    case TOGGLE_SWITCH:
      return {
        ...state, // ë¶ˆë³€ì„± ìœ ì§€ë¥¼ í•´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.
        toggle: !state.toggle
      };
    case INCREASE:
      return {
        ...state,
        counter: state.counter + action.difference
      };
    case DECREASE:
      return {
        ...state,
        counter: state.counter - 1
      };
    default:
      return state;
  }
}
```

### 16.2.7 ìŠ¤í† ì–´ ë§Œë“¤ê¸°

***createStore*** í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

- ì½”ë“œ ìƒë‹¨ì— import êµ¬ë¬¸ìœ¼ë¡œ ë¦¬ë•ìŠ¤ì—ì„œ í•´ë‹¹ í•¨ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°
- í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ì— ë¦¬ë“€ì„œ í•¨ìˆ˜ë¥¼ ë„£ì–´ì£¼ê¸°

```jsx
import { legacy_createStore as createStore } from "redux";
/* ì·¨ì†Œì„  ì˜¤ë¥˜ í•´ê²° */
(...)
const store = createStore(reducer);
```

### 16.2.8 render í•¨ìˆ˜ ë§Œë“¤ê¸°

***render***

- ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë  ë•Œë§ˆë‹¤ í˜¸ì¶œë¨
- â‰  ë¦¬ì•¡íŠ¸ render
- htmlì„ ì‚¬ìš©í•˜ì—¬ ë§Œë“¤ì–´ì§„ UIì˜ ì†ì„±ì„ ìƒíƒœì— ë”°ë¼ ë³€ê²½í•´ì¤€ë‹¤.

```jsx
const render = () => {
  const state = store.getState(); // í˜„ì¬ ìƒíƒœë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
  // í† ê¸€ ì²˜ë¦¬
  if (state.toggle) {
    divToggle.classList.add('active');
  } else {
    divToggle.classList.remove('active');
  }
  // ì¹´ìš´í„° ì²˜ë¦¬
  counter.innerText = state.counter;
};

render();
```

### 16.2.9 êµ¬ë…í•˜ê¸°

ìŠ¤í† ì–´ì˜ ìƒíƒœê°€ ë°”ë€” ë•Œë§ˆë‹¤ render í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë„ë¡ í•˜ê¸°

â†’ ìŠ¤í† ì–´ì˜ ë‚´ì¥ í•¨ìˆ˜ ***subscribe***ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•˜ê¸°

- ***subscribe*** í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°: í•¨ìˆ˜ í˜•íƒœì˜ ê°’

```jsx
store.subscribe(render);
```

### 16.2.10 ì•¡ì…˜ ë°œìƒì‹œí‚¤ê¸°

***ë””ìŠ¤íŒ¨ì¹˜, ì•¡ì…˜ì„ ë°œìƒì‹œí‚¤ëŠ” ê²ƒ***

- ìŠ¤í† ì–´ì˜ ë‚´ì¥ í•¨ìˆ˜ dispatch ì‚¬ìš©
- íŒŒë¼ë¯¸í„°: ì•¡ì…˜ ê°ì²´

```jsx
(...)
divToggle.onclick = () => {
  store.dispatch(toggleSwitch());
};
btnIncrease.onclick = () => {
  store.dispatch(increase(1));
};
btnDecrease.onclick = () => {
  store.dispatch(decrease());
};
```

â†’ DOM ìš”ì†Œì— í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •

â†’ ì´ë²¤íŠ¸ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ dispatch í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•¡ì…˜ì„ ìŠ¤í† ì–´ì—ê²Œ ì „ë‹¬

## **16.3Â ë¦¬ë•ìŠ¤ì˜ ì„¸ ê°€ì§€ ê·œì¹™**

### 16.3.1 ë‹¨ì¼ ìŠ¤í† ì–´

í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì•ˆì—ëŠ” í•˜ë‚˜ì˜ ìŠ¤í† ì–´ë§Œ!

### 16.3.2 ì½ê¸° ì „ìš© ìƒíƒœ

- ë¦¬ë•ìŠ¤ ìƒíƒœ: ì½ê¸° ì „ìš©
- ìƒíƒœ ì—…ë°ì´íŠ¸í•  ë•Œ: ìˆ˜ì •X, ìƒˆë¡œìš´ ê°ì²´ ìƒì„±í•˜ê¸°
- ë¶ˆë³€ì„± ìœ ì§€ â†’ ë‚´ë¶€ì ìœ¼ë¡œ ë°ì´í„°ê°€ ë³€ê²½ë˜ëŠ” ê²ƒì„ ê°ì§€í•˜ê¸° ìœ„í•´ ì–•ì€ ë¹„êµ ê²€ì‚¬ë¥¼ í•œë‹¤.

### 16.3.3 ë¦¬ë“€ì„œëŠ” ìˆœìˆ˜í•œ í•¨ìˆ˜

***ë¦¬ë“€ì„œ í•¨ìˆ˜***

- íŒŒë¼ë¯¸í„°: ì´ì „ ìƒíƒœ, ì•¡ì…˜ ê°ì²´
- íŒŒë¼ë¯¸í„° ì™¸ì˜ ê°’ì— ì˜ì¡´X
- ì´ì „ ìƒíƒœ ê±´ë“œë¦¼X, ìƒˆë¡œìš´ ìƒíƒœ ê°ì²´ ìƒì„± í›„ ë°˜í™˜
- ë˜‘ê°™ì€ íŒŒë¼ë¯¸í„°ë¡œ í˜¸ì¶œëœ ë¦¬ë“€ì„œ í•¨ìˆ˜ â†’ ì–¸ì œë‚˜ ê°™ì€ ê°’ ë°˜í™˜

## 16.4 ì •ë¦¬

**ë¦¬ë•ìŠ¤ ì½”ë“œì˜ ì‘ì„± íë¦„**

1. ì•¡ì…˜ íƒ€ì…, ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ ì‘ì„±í•˜ê¸°
2. ë¦¬ë“€ì„œ ì‘ì„±í•˜ê¸°
3. ìŠ¤í† ì–´ ìƒì„±í•˜ê¸°

# 17ì¥ **ë¦¬ë•ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ì•¡íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ê´€ë¦¬í•˜ê¸°**

## **17.1Â ì‘ì—… í™˜ê²½ ì„¤ì •**

`$ yarn create react-app react-redux-tutorial`

`$ cd react-redux-tutorial`

`$ yarn add redux react-redux`

Prettier ì ìš©í•˜ê¸°

```jsx
{
  "singleQuote": true,
  "semi": true,
  "useTabs": false,
  "tabWidth": 2,
  "trailingComma": "all",
  "printWidth": 80
}
```

## **17.2Â UI ì¤€ë¹„í•˜ê¸°**

***í”„ë ˆì  í…Œì´ì…”ë„ ì»´í¬ë„ŒíŠ¸***

- ìƒíƒœ ê´€ë¦¬ê°€ ì´ë£¨ì–´ì§€ì§€ ì•ŠìŒ
- propsë¥¼ ë°›ì•„ ì™€ì„œ í™”ë©´ì— UIë¥¼ ë³´ì—¬ ì£¼ê¸°ë§Œ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸

***ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸***

- ë¦¬ë•ìŠ¤ì™€ ì—°ë™ë˜ì–´ ìˆëŠ” ì»´í¬ë„ŒíŠ¸
- ë¦¬ë•ìŠ¤ë¡œë¶€í„° ìƒíƒœ ë°›ì•„ì˜¤ê¸°
- ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ì— ì•¡ì…˜ì„ ë””ìŠ¤íŒ¨ì¹˜ í•˜ê¸°

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/6e91f198-8ab1-4084-8764-bcd7b8ca4af6/3ef1559e-9072-4965-ac51-52ccab7faf90/Untitled.png)

í”„ë ˆì  í…Œì´ì…”ë„ ì»´í¬ë„ŒíŠ¸ì™€ ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¶„ë¦¬í•˜ê¸°!

â†’ UIì— ê´€ë ¨ëœ í”„ë ˆì  í…Œì´ì…”ë„ ì»´í¬ë„ŒíŠ¸ëŠ” src/components ê²½ë¡œì— ì €ì¥í•˜ê¸°

â†’ ë¦¬ë•ìŠ¤ì™€ ì—°ë™ëœ ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ëŠ” src/containers ì»´í¬ë„ŒíŠ¸ì— ì‘ì„±í•˜ê¸°

### 17.2.1 ì¹´ìš´í„° ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

```jsx
import React from 'react';

const Counter = ({ number, onIncrease, onDecrease }) => {
  return (
    <div>
      <h1>{number}</h1>
      <div>
        <button onClick={onIncrease}>+1</button>
        <button onClick={onDecrease}>-1</button>
      </div>
    </div>
  );
};

export default Counter;
```

```jsx
import React from 'react';
import Counter from './components/Counter';

const App = () => {
  return (
    <div>
      <Counter number={0} />
    </div>
  );
};

export default App;
```

`$ yarn start` â†’ ì„œë²„ ì‹¤í–‰í•˜ê¸°

## 17.2.2 í•  ì¼ ëª©ë¡ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

```jsx
import React from 'react';

const TodoItem = ({ todo, onToggle, onRemove }) => {
  return (
    <div>
      <input type="checkbox" />
      <span>ì˜ˆì œ í…ìŠ¤íŠ¸</span>
      <button>ì‚­ì œ</button>
    </div>
  );
};

const Todos = ({
  input, // ì¸í’‹ì— ì…ë ¥ë˜ëŠ” í…ìŠ¤íŠ¸
  todos, // í•  ì¼ ëª©ë¡ì´ ë“¤ì–´ ìˆëŠ” ê°ì²´
  onChangeInput,
  onInsert,
  onToggle,
  onRemove,
}) => {
  const onSubmit = e => {
    e.preventDefault();
  };
  return (
    <div>
      <form onSubmit={onSubmit}>
        <input />
        <button type="submit">ë“±ë¡</button>
      </form>
      <div>
        <TodoItem />
        <TodoItem />
        <TodoItem />
        <TodoItem />
        <TodoItem />
      </div>
    </div>
  );
};

export default Todos;
```

```jsx
import React from 'react';
import Counter from './components/Counter';
import Todos from './components/Todos';

const App = () => {
  return (
    <div>
      <Counter number={0} />
      <hr />
      <Todos />
    </div>
  );
};

export default App;
```

## **17.3Â ë¦¬ë•ìŠ¤ ê´€ë ¨ ì½”ë“œ ì‘ì„±í•˜ê¸°**

***ë¦¬ë•ìŠ¤ ê´€ë ¨ ì½”ë“œ***

- ì•¡ì…˜ íƒ€ì…
- ì•¡ì…˜ ìƒì„± í•¨ìˆ˜
- ë¦¬ë“€ì„œ ì½”ë“œ

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/6e91f198-8ab1-4084-8764-bcd7b8ca4af6/005bf7c4-eb1d-4021-a3c6-014a1aabca4b/Untitled.png)

â†’ ì¼ë°˜ì ì¸ êµ¬ì¡° (ë””ë ‰í† ë¦¬ 3ê°œ, ê¸°ëŠ¥ë³„ë¡œ íŒŒì¼ ìƒì„±)

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/6e91f198-8ab1-4084-8764-bcd7b8ca4af6/a0b51928-e2f8-469b-9690-40414523b201/Untitled.png)

â†’ Ducks íŒ¨í„´ (ê¸°ëŠ¥ë³„ë¡œ íŒŒì¼ í•˜ë‚˜ì— ëª°ì•„ì„œ ì‘ì„±)

## 17.3.1 counter ëª¨ë“ˆ ì‘ì„±í•˜ê¸°

***ëª¨ë“ˆ: Ducks íŒ¨í„´ì„ ì‚¬ìš©í•˜ì—¬ ì•¡ì…˜ íƒ€ì…, ì•¡ì…˜ ìƒì„± í•¨ìˆ˜, ë¦¬ë“€ì„œë¥¼ ì‘ì„±í•œ ì½”ë“œ***

### 17.3.1.1 ì•¡ì…˜ íƒ€ì… ì •ì˜í•˜ê¸°

```jsx
const INCREASE = 'counter/INCREASE';
const DECREASE = 'counter/DECREASE';
```

- ì•¡ì…˜ íƒ€ì… (ì´ë¦„) : ëŒ€ë¬¸ì
- ë‚´ìš©: â€˜ëª¨ë“ˆ ì´ë¦„/ì•¡ì…˜ ì´ë¦„â€™

### 17.3.1.2 ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ ë§Œë“¤ê¸°

```jsx
export const increase = () => ({ type: INCREASE });
export const decrease = () => ({ type: DECREASE });
```

***export:*** ë‹¤ë¥¸ íŒŒì¼ì—ì„œ ì‚¬ìš© ê°€ëŠ¥

### 17.3.1.3 ì´ˆê¸° ìƒíƒœ ë° ë¦¬ë“€ì„œ í•¨ìˆ˜ ë§Œë“¤ê¸°

```jsx
const initialState = {
  number: 0 /* ì´ˆê¸°ê°’ 0 */
};

function counter(state = initialState, action) {
  switch (action.type) {
    case INCREASE:
      return {
        number: state.number + 1
      };
    case DECREASE:
      return {
        number: state.number - 1
      };
    default:
      return state;
  }
}

export default counter; //í•¨ìˆ˜ ë‚´ë³´ë‚´ê¸°
```

- export, ì—¬ëŸ¬ ê°œë¥¼ ë‚´ë³´ë‚¼ ìˆ˜ ìˆë‹¤.
- export default, í•œ ê°œë§Œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆë‹¤.

### 17.3.2 todos ëª¨ë“ˆ ë§Œë“¤ê¸°

```jsx
const CHANGE_INPUT = 'todos/CHANGE_INPUT'; // ì¸í’‹ ê°’ì„ ë³€ê²½í•¨
const INSERT = 'todos/INSERT'; // ìƒˆë¡œìš´ todoë¥¼ ë“±ë¡í•¨
const TOGGLE = 'todos/TOGGLE'; // todoë¥¼ ì²´í¬/ì²´í¬ í•´ì œí•¨
const REMOVE = 'todos/REMOVE'; // todoë¥¼ ì œê±°í•¨
```

### 17.3.2.2 ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ ë§Œë“¤ê¸°

**ì•¡ì…˜ ìƒì„± í•¨ìˆ˜**ì—ì„œ **íŒŒë¼ë¯¸í„°**ê°€ ****í•„ìš”í•˜ë‹¤

â†’ íŒŒë¼ë¯¸í„°ëŠ” ì•¡ì…˜ ê°ì²´ ì•ˆì— ìˆëŠ” **ì¶”ê°€ í•„ë“œ**ë¡œ ë“¤ì–´ê°„ë‹¤.

```jsx
export const changeInput = input => ({
  type: CHANGE_INPUT,
  input
});

let id = 3; // insertê°€ í˜¸ì¶œë  ë•Œë§ˆë‹¤ 1ì”© ë”í•´ì§‘ë‹ˆë‹¤.
export const insert = text => ({
  type: INSERT,
  todo: {
    id: id++,
    text,
    done: false
  }
});

export const toggle = id => ({
  type: TOGGLE,
  id
});

export const remove = id => ({
  type: REMOVE,
  id
});
```

### 17.3.2.3 ì´ˆê¸° ìƒíƒœ ë° ë¦¬ë“€ì„œ í•¨ìˆ˜ ë§Œë“¤ê¸°

âš ï¸***spread ì—°ì‚°ì(â€¦)***âš ï¸

```jsx
(...)
const initialState = {
  input: '',
  todos: [
    {
      id: 1,
      text: 'ë¦¬ë•ìŠ¤ ê¸°ì´ˆ ë°°ìš°ê¸°',
      done: true
    },
    {
      id: 2,
      text: 'ë¦¬ì•¡íŠ¸ì™€ ë¦¬ë•ìŠ¤ ì‚¬ìš©í•˜ê¸°',
      done: false
    }
  ]
};

function todos(state = initialState, action) {
  switch (action.type) {
    case CHANGE_INPUT:
      return {
        ...state,
        input: action.input
      };
    case INSERT:
      return {
        ...state,
        todos: state.todos.concat(action.todo)
      };
    case TOGGLE:
      return {
        ...state,
        todos: state.todos.map(todo =>
          todo.id === action.id ? { ...todo, done: !todo.done } : todo
        )
      };
    case REMOVE:
      return {
        ...state,
        todos: state.todos.filter(todo => todo.id !== action.id)
      };
    default:
      return state;
  }
}

export default todos;
```

### 17.3.3 ë£¨íŠ¸ ë¦¬ë“€ì„œ ë§Œë“¤ê¸°

ê¸°ì¡´ ë¦¬ë“€ì„œ í•˜ë‚˜ë¡œ í•©ì¹˜ê¸°

â†’ ***combineReducers*** ìœ í‹¸ í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

```jsx
import { combineReducers } from 'redux';
import counter from './counter';
import todos from './todos';

const rootReducer = combineReducers({
  counter,
  todos,
});

export default rootReducer;
```

ë¶ˆëŸ¬ì˜¬ ë•Œ: `import rootReducer from './modules';`

## **17.4Â ë¦¬ì•¡íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë¦¬ë•ìŠ¤ ì ìš©í•˜ê¸°**

### 17.4.1 ìŠ¤í† ì–´ ë§Œë“¤ê¸°

```jsx
import React from 'react';
import ReactDOM from 'react-dom';
import { createStore } from 'redux';
import './index.css';
import App from './App';
import * as serviceWorker from './serviceWorker';
import rootReducer from './modules';

const store = createStore(rootReducer);

ReactDOM.render(<App />, document.getElementById('root'));

serviceWorker.unregister();
```

### 17.4.2 Provider ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ì— ë¦¬ë•ìŠ¤ ì ìš©í•˜ê¸°

ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìŠ¤í† ì–´ ì‚¬ìš©í•˜ê¸° â†’ ***Provider*** ì»´í¬ë„ŒíŠ¸ë¡œ ê°ì‹¸ì£¼ê¸°

ğŸ›‘storeë¥¼ propsë¡œ ì „ë‹¬í•´ ì£¼ì–´ì•¼ í•œë‹¤.

```jsx
import React from 'react';
import ReactDOM from 'react-dom';
import { createStore } from 'redux';
import { Provider } from 'react-redux';
import './index.css';
import App from './App';
import * as serviceWorker from './serviceWorker';
import rootReducer from './modules';

const store = createStore(rootReducer);

ReactDOM.render(
  <Provider store={store}>
    <App />
  </Provider>,
  document.getElementById('root'),
);

serviceWorker.unregister();
```

### 17.4.3 Redux DevToolsì˜ ì„¤ì¹˜ ë° ì ìš©

í¬ë¡¬ ì›¹ ìŠ¤í† ì–´ https://chrome.google.com/webstore

â†’ Redux DevTools ì„¤ì¹˜

`$ yarn add redux-devtools-extension`

â†’ ì½”ë“œê°€ ê¹”ë”í•´ì ¸ìš”~

âš ï¸ì˜¤ë¥˜ ë°©ì§€: src ì•ˆì— **serviceWorker.js ìƒì„± í›„ ë³µë¶™**

```jsx
// This optional code is used to register a service worker.
// register() is not called by default.

// This lets the app load faster on subsequent visits in production, and gives
// it offline capabilities. However, it also means that developers (and users)
// will only see deployed updates on subsequent visits to a page, after all the
// existing tabs open on the page have been closed, since previously cached
// resources are updated in the background.

// To learn more about the benefits of this model and instructions on how to
// opt-in, read http://bit.ly/CRA-PWA

const isLocalhost = Boolean(
  window.location.hostname === 'localhost' ||
    // [::1] is the IPv6 localhost address.
    window.location.hostname === '[::1]' ||
    // 127.0.0.1/8 is considered localhost for IPv4.
    window.location.hostname.match(
      /^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/
    )
);

export function register(config) {
  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {
    // The URL constructor is available in all browsers that support SW.
    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);
    if (publicUrl.origin !== window.location.origin) {
      // Our service worker won't work if PUBLIC_URL is on a different origin
      // from what our page is served on. This might happen if a CDN is used to
      // serve assets; see https://github.com/facebook/create-react-app/issues/2374
      return;
    }

    window.addEventListener('load', () => {
      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;

      if (isLocalhost) {
        // This is running on localhost. Let's check if a service worker still exists or not.
        checkValidServiceWorker(swUrl, config);

        // Add some additional logging to localhost, pointing developers to the
        // service worker/PWA documentation.
        navigator.serviceWorker.ready.then(() => {
          console.log(
            'This web app is being served cache-first by a service ' +
              'worker. To learn more, visit http://bit.ly/CRA-PWA'
          );
        });
      } else {
        // Is not localhost. Just register service worker
        registerValidSW(swUrl, config);
      }
    });
  }
}

function registerValidSW(swUrl, config) {
  navigator.serviceWorker
    .register(swUrl)
    .then(registration => {
      registration.onupdatefound = () => {
        const installingWorker = registration.installing;
        if (installingWorker == null) {
          return;
        }
        installingWorker.onstatechange = () => {
          if (installingWorker.state === 'installed') {
            if (navigator.serviceWorker.controller) {
              // At this point, the updated precached content has been fetched,
              // but the previous service worker will still serve the older
              // content until all client tabs are closed.
              console.log(
                'New content is available and will be used when all ' +
                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'
              );

              // Execute callback
              if (config && config.onUpdate) {
                config.onUpdate(registration);
              }
            } else {
              // At this point, everything has been precached.
              // It's the perfect time to display a
              // "Content is cached for offline use." message.
              console.log('Content is cached for offline use.');

              // Execute callback
              if (config && config.onSuccess) {
                config.onSuccess(registration);
              }
            }
          }
        };
      };
    })
    .catch(error => {
      console.error('Error during service worker registration:', error);
    });
}

function checkValidServiceWorker(swUrl, config) {
  // Check if the service worker can be found. If it can't reload the page.
  fetch(swUrl)
    .then(response => {
      // Ensure service worker exists, and that we really are getting a JS file.
      const contentType = response.headers.get('content-type');
      if (
        response.status === 404 ||
        (contentType != null && contentType.indexOf('javascript') === -1)
      ) {
        // No service worker found. Probably a different app. Reload the page.
        navigator.serviceWorker.ready.then(registration => {
          registration.unregister().then(() => {
            window.location.reload();
          });
        });
      } else {
        // Service worker found. Proceed as normal.
        registerValidSW(swUrl, config);
      }
    })
    .catch(() => {
      console.log(
        'No internet connection found. App is running in offline mode.'
      );
    });
}

export function unregister() {
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.ready.then(registration => {
      registration.unregister();
    });
  }
}
```

## **17.5Â ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°**

***ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸: ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ì™€ ì—°ë™ëœ ì»´í¬ë„ŒíŠ¸***

```jsx
import React from 'react';
import Counter from '../components/Counter';

const CounterContainer = () => {
  return <Counter />;
};

export default CounterContainer;
```

`connect(mapStateToProps, mapDispatchToProps)(ì—°ë™í•  ì»´í¬ë„ŒíŠ¸)`

***mapStateToProps:*** 

ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ ì•ˆì˜ ìƒíƒœë¥¼ ì»´í¬ë„ŒíŠ¸ì˜ propsë¡œ ë„˜ê²¨ì£¼ê¸° ìœ„í•´ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜

***mapDispatchToProps:***

ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ë¥¼ ì»´í¬ë„ŒíŠ¸ì˜ propsë¡œ ë„˜ê²¨ì£¼ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜

connect í•¨ìˆ˜ í˜¸ì¶œ í›„ ë‹¤ë¥¸ í•¨ìˆ˜ ë°˜í™˜

â†’ ë°˜í™˜ëœ í•¨ìˆ˜ì— ì»´í¬ë„ŒíŠ¸ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„£ê¸°

â†’ ë¦¬ë•ìŠ¤ì™€ ì—°ë™ëœ ì»´í¬ë„ŒíŠ¸ ìƒì„±ë¨

**ì •ë¦¬**

`const makeContainter = connect(mapStateToProps, mapDispatchToProps)`

`makeContainter(íƒ€ê¹ƒ ì»´í¬ë„ŒíŠ¸)`

```jsx
import React from 'react';
import { connect } from 'react-redux';
import Counter from '../components/Counter';

const CounterContainer = ({ number, increase, decrease }) => {
  return (
    <Counter number={number} onIncrease={increase} onDecrease={decrease} />
  );
};

const mapStateToProps = state => ({
  number: state.counter.number,
});
const mapDispatchToProps = dispatch => ({
  // ì„ì‹œ í•¨ìˆ˜
  increase: () => {
    console.log('increase');
  },
  decrease: () => {
    console.log('decrease');
  },
});
export default connect(
  mapStateToProps,
  mapDispatchToProps,
)(CounterContainer);
```

```jsx
import React from 'react';
import Todos from './components/Todos';
import CounterContainer from './containers/CounterContainer';

const App = () => {
  return (
    <div>
      <CounterContainer />
      <hr />
      <Todos />
    </div>
  );
};

export default App;
```

```jsx
import React from 'react';
import { connect } from 'react-redux';
import Counter from '../components/Counter';
import { increase, decrease } from '../modules/counter'; // ì¶”ê°€ë¨

const CounterContainer = ({ number, increase, decrease }) => {
  return (
    <Counter number={number} onIncrease={increase} onDecrease={decrease} />
  );
};

const mapStateToProps = state => ({
  number: state.counter.number,
});
const mapDispatchToProps = dispatch => ({
  increase: () => {
    dispatch(increase()); /* ì¶”ê°€ë¨ */
  },
  decrease: () => {
    dispatch(decrease()); /* ì¶”ê°€ë¨ */
  },
});
export default connect(
  mapStateToProps,
  mapDispatchToProps,
)(CounterContainer);
```

```jsx
export default connect(
  state => ({
    number: state.counter.number,
  }),
  dispatch => ({
    increase: () => dispatch(increase()),
    decrease: () => dispatch(decrease()),
  }),
)(CounterContainer);
```

â†’ ë¶ˆí•„ìš”í•œ ì½”ë“œ ë¸”ë¡ ìƒëµ (ì‘ë™ ë°©ì‹ ë™ì¼)

`increase: () => dispatch(increase()),`

`increase: () => { return dispatch(increase()) },`

***bindActionCreators ìœ í‹¸ í•¨ìˆ˜ ì‚¬ìš©***

â†’ ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ ê°œìˆ˜ê°€ ë§ì„ ë•Œ

```jsx
import React from 'react';
import { bindActionCreators } from 'redux';
import { connect } from 'react-redux';
import Counter from '../components/Counter';
import { increase, decrease } from '../modules/counter';

const CounterContainer = ({ number, increase, decrease }) => {
  return (
    <Counter number={number} onIncrease={increase} onDecrease={decrease} />
  );
};

export default connect(
  state => ({
    number: state.counter.number,
  }),
  dispatch =>
    bindActionCreators(
      {
        increase,
        decrease,
      },
      dispatch,
    ),
)(CounterContainer);
```

***mapDispatchToProps***ì— í•´ë‹¹í•˜ëŠ” íŒŒë¼ë¯¸í„°

â†’ í•¨ìˆ˜ í˜•íƒœ X

â†’ ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ë¡œ ì´ë£¨ì–´ì§„ ê°íƒœ

```jsx
export default connect(
  state => ({
    number: state.counter.number,
  }),
  {
    increase,
    decrease,
  },
)(CounterContainer);
```

*ë‚´ë¶€ì ìœ¼ë¡œ bindActionCreators ì‘ì—…ì„ ëŒ€ì‹  í•´ì¤€ë‹¤!*

### 17.5.2 TodosContainer ë§Œë“¤ê¸°

- ***connect*** í•¨ìˆ˜ ì‚¬ìš©
- ***mapDispatchToProps***ë¥¼ ì§§ê³  ê°„ë‹¨í•˜ê²Œ ì“°ëŠ” ë°©ë²•ì„ ì ìš©

```jsx
import React from 'react';
import { connect } from 'react-redux';
import { changeInput, insert, toggle, remove } from '../modules/todos';
import Todos from '../components/Todos';

const TodosContainer = ({
  input,
  todos,
  changeInput,
  insert,
  toggle,
  remove,
}) => {
  return (
    <Todos
      input={input}
      todos={todos}
      onChangeInput={changeInput}
      onInsert={insert}
      onToggle={toggle}
      onRemove={remove}
    />
  );
};

export default connect(
  // ë¹„êµ¬ì¡°í™” í• ë‹¹ì„ í†µí•´ todosë¥¼ ë¶„ë¦¬í•˜ì—¬
  // state.todos.input ëŒ€ì‹  todos.inputì„ ì‚¬ìš©
  ({ todos }) => ({
    input: todos.input,
    todos: todos.todos,
  }),
  {
    changeInput,
    insert,
    toggle,
    remove,
  },
)(TodosContainer);
```

```jsx
import React from 'react';
import CounterContainer from './containers/CounterContainer';
import TodosContainer from './containers/TodosContainer';

const App = () => {
  return (
    <div>
      <CounterContainer />
      <hr />
      <TodosContainer />
    </div>
  );
};

export default App;
```

Todos ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°›ì•„ ì˜¨ propsë¥¼ ì‚¬ìš©í•˜ë„ë¡ êµ¬í˜„í•˜ê¸°

```jsx
import React from 'react';

const TodoItem = ({ todo, onToggle, onRemove }) => {
  return (
    <div>
      <input
        type="checkbox"
        onClick={() => onToggle(todo.id)}
        checked={todo.done}
        readOnly={true}
      />
      <span style={{ textDecoration: todo.done ? 'line-through' : 'none' }}>
        {todo.text}
      </span>
      <button onClick={() => onRemove(todo.id)}>ì‚­ì œ</button>
    </div>
  );
};

const Todos = ({
  input, // ì¸í’‹ì— ì…ë ¥ë˜ëŠ” í…ìŠ¤íŠ¸
  todos, // í•  ì¼ ëª©ë¡ì´ ë“¤ì–´ ìˆëŠ” ê°ì²´
  onChangeInput,
  onInsert,
  onToggle,
  onRemove,
}) => {
  const onSubmit = e => {
    e.preventDefault();
    onInsert(input);
    onChangeInput(''); // ë“±ë¡ í›„ ì¸í’‹ ì´ˆê¸°í™”
  };
  const onChange = e => onChangeInput(e.target.value);
  return (
    <div>
      <form onSubmit={onSubmit}>
        <input value={input} onChange={onChange} />
        <button type="submit">ë“±ë¡</button>
      </form>
      <div>
        {todos.map(todo => (
          <TodoItem
            todo={todo}
            key={todo.id}
            onToggle={onToggle}
            onRemove={onRemove}
          />
        ))}
      </div>
    </div>
  );
};

export default Todos;
```

## **17.6Â ë¦¬ë•ìŠ¤ ë” í¸í•˜ê²Œ ì‚¬ìš©í•˜ê¸°**

- redux-actions ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- immer ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

### 17.6.1 redux-actions

`$ yarn add redux-actions`

### 17.6.1.1 counter ëª¨ë“ˆì— ì ìš©í•˜ê¸°

***createAction*** í•¨ìˆ˜ ì‚¬ìš©

```jsx
import { createAction } from 'redux-actions';

const INCREASE = 'counter/INCREASE';
const DECREASE = 'counter/DECREASE';

export const increase = createAction(INCREASE);
export const decrease = createAction(DECREASE);

(...)
```

***handleActions*** í•¨ìˆ˜ ì‚¬ìš©

- ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°: ê° ì•¡ì…˜ì— ëŒ€í•œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë¥¼ ë„£ê¸°
- ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°: ì´ˆê¸° ìƒíƒœë¥¼ ë„£ê¸°

```jsx
import { createAction, handleActions } from 'redux-actions';

const INCREASE = 'counter/INCREASE';
const DECREASE = 'counter/DECREASE';

export const increase = createAction(INCREASE);
export const decrease = createAction(DECREASE);

const initialState = {
  number: 0,
};

const counter = handleActions(
  {
    [INCREASE]: (state, action) => ({ number: state.number + 1 }),
    [DECREASE]: (state, action) => ({ number: state.number - 1 }),
  },
  initialState,
);

export default counter;
```

### 17.6.1.2 todos ëª¨ë“ˆì— ì ìš©í•˜ê¸°

ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ì—ì„œ ê°ê°ì˜ íŒŒë¼ë¯¸í„°ë¥¼ í•„ìš”ë¡œ í•œë‹¤.

â†’ ë‘ ë²ˆì§¸ í•¨ìˆ˜ì— ì •ì˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë”°ë¡œ ì„ ì–¸í•´ì„œ ë„£ê¸°

```jsx
import { createAction } from 'redux-actions';

const CHANGE_INPUT = 'todos/CHANGE_INPUT'; // ì¸í’‹ ê°’ì„ ë³€ê²½í•¨
const INSERT = 'todos/INSERT'; // ìƒˆë¡œìš´ todoë¥¼ ë“±ë¡í•¨
const TOGGLE = 'todos/TOGGLE'; // todoë¥¼ ì²´í¬/ì²´í¬ í•´ì œí•¨
const REMOVE = 'todos/REMOVE'; // todoë¥¼ ì œê±°í•¨

export const changeInput = createAction(CHANGE_INPUT, input => input);

let id = 3; // insertê°€ í˜¸ì¶œë  ë•Œë§ˆë‹¤ 1ì”© ë”í•´ì§‘ë‹ˆë‹¤.
export const insert = createAction(INSERT, text => ({
  id: id++,
  text,
  done: false,
}));

export const toggle = createAction(TOGGLE, id => id);
export const remove = createAction(REMOVE, id => id);

(...)
```

ì•¡ì…˜ ìƒì„± í•¨ìˆ˜

- ì•¡ì…˜ì— í•„ìš”í•œ ì¶”ê°€ ë°ì´í„°ë¥¼ payloadë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.
- ëª¨ë‘ ê³µí†µì ìœ¼ë¡œ action.payload ê°’ì„ ì¡°íšŒí•˜ë„ë¡ ë¦¬ë“€ì„œë¥¼ êµ¬í˜„í•˜ê¸°

```jsx
import { createAction, handleActions } from 'redux-actions';

(...)

const todos = handleActions(
  {
    [CHANGE_INPUT]: (state, { payload: input }) => ({ ...state, input }),
    [INSERT]: (state, { payload: todo }) => ({
      ...state,
      todos: state.todos.concat(todo),
    }),
    [TOGGLE]: (state, { payload: id }) => ({
      ...state,
      todos: state.todos.map(todo =>
        todo.id === id ? { ...todo, done: !todo.done } : todo,
      ),
    }),
    [REMOVE]: (state, { payload: id }) => ({
      ...state,
      todos: state.todos.filter(todo => todo.id !== id),
    }),
  },
  initialState,
);

export default todos;
```

## 17.6.2 immer

`$ yarn add immer`

```jsx
import { createAction, handleActions } from 'redux-actions';
import produce from 'immer';

(...)

const todos = handleActions(
  {
    [CHANGE_INPUT]: (state, { payload: input }) =>
      produce(state, draft => {
        draft.input = input;
      }),
    [INSERT]: (state, { payload: todo }) =>
      produce(state, draft => {
        draft.todos.push(todo);
      }),
    [TOGGLE]: (state, { payload: id }) =>
      produce(state, draft => {
        const todo = draft.todos.find(todo => todo.id === id);
        todo.done = !todo.done;
      }),
    [REMOVE]: (state, { payload: id }) =>
      produce(state, draft => {
        const index = draft.todos.findIndex(todo => todo.id === id);
        draft.todos.splice(index, 1);
      }),
  },
  initialState,
);

export default todos;
```

## **17.7Â Hooksë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°**

***connect*** í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  react-reduxì—ì„œ ì œê³µí•˜ëŠ” ***Hooks***ë¥¼ ì‚¬ìš©í•˜ê¸°

### 17.7.1 useSelectorë¡œ ìƒíƒœ ì¡°íšŒí•˜ê¸°

connect í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ë¦¬ë•ìŠ¤ì˜ ìƒíƒœë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

`const ê²°ê³¼ = useSelector(ìƒíƒœ ì„ íƒ í•¨ìˆ˜);`

***CounterContainer***ì—ì„œ ***connect*** í•¨ìˆ˜ ëŒ€ì‹  ***useSelector***ë¥¼ ì‚¬ìš©í•˜ì

â†’ ***counter.number*** ê°’ì„ ì¡°íšŒí•¨ìœ¼ë¡œì¨ Counterì—ê²Œ propsë¥¼ ë„˜ê²¨ì¤€ë‹¤.

```jsx
import React from 'react';
import { useSelector } from 'react-redux';
import Counter from '../components/Counter';
import { increase, decrease } from '../modules/counter';

const CounterContainer = () => {
  const number = useSelector(state => state.counter.number);
  return <Counter number={number} />;
};

export default CounterContainer;
```

### 17.7.2 useDispatchë¥¼ ì‚¬ìš©í•˜ì—¬ ì•¡ì…˜ ë””ìŠ¤íŒ¨ì¹˜í•˜ê¸°

ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ìŠ¤í† ì–´ì˜ ë‚´ì¥ í•¨ìˆ˜ dispatchë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

`const dispatch = useDispatch();`

`dispatch({ type: 'SAMPLE_ACTION' });`

```jsx
import React from 'react';
import { useSelector, useDispatch } from 'react-redux';
import Counter from '../components/Counter';
import { increase, decrease } from '../modules/counter';

const CounterContainer = () => {
  const number = useSelector(state => state.counter.number);
  const dispatch = useDispatch();
  return (
    <Counter
      number={number}
      onIncrease={() => dispatch(increase())}
      onDecrease={() => dispatch(decrease())}
    />
  );
};

export default CounterContainer;
```

ì»´í¬ë„ŒíŠ¸ ì„±ëŠ¥ì„ ìµœì í™”í•˜ê¸°

 â†’ ***useCallback***ìœ¼ë¡œ ì•¡ì…˜ì„ ë””ìŠ¤íŒ¨ì¹˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ê°ì‹¸ ì¤€ë‹¤.

```jsx
import React, { useCallback } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import Counter from '../components/Counter';
import { increase, decrease } from '../modules/counter';

const CounterContainer = () => {
  const number = useSelector(state => state.counter.number);
  const dispatch = useDispatch();
  const onIncrease = useCallback(() => dispatch(increase()), [dispatch]);
  const onDecrease = useCallback(() => dispatch(decrease()), [dispatch]);
  return (
    <Counter number={number} onIncrease={onIncrease} onDecrease={onDecrease} />
  );
};

export default CounterContainer;
```

âœ”ï¸**useDispatch**ê³¼ **useCallback**ì„ í•¨ê»˜ ì‚¬ìš©í•˜ì!

### 17.7.3 useStoreë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ ì‚¬ìš©í•˜ê¸°

ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ ê°ì²´ë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

`const store = useStore();`

`store.dispatch({ type: 'SAMPLE_ACTION '});`

`store.getState();`

### 17.7.4 TodosContainerë¥¼ Hooksë¡œ ì „í™˜í•˜ê¸°

***TodosContainer***

â†’ ***connect*** í•¨ìˆ˜ ëŒ€ì‹ ì— ***useSelector***ì™€ ***useDispatch***ë¥¼ ì‚¬ìš©!

```jsx
import React, { useCallback } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { changeInput, insert, toggle, remove } from '../modules/todos';
import Todos from '../components/Todos';

const TodosContainer = () => {
  const { input, todos } = useSelector(({ todos }) => ({
    input: todos.input,
    todos: todos.todos
  }));
  const dispatch = useDispatch();
  const onChangeInput = useCallback(input => dispatch(changeInput(input)), [
    dispatch
  ]);
  const onInsert = useCallback(text => dispatch(insert(text)), [dispatch]);
  const onToggle = useCallback(id => dispatch(toggle(id)), [dispatch]);
  const onRemove = useCallback(id => dispatch(remove(id)), [dispatch]);

  return (
    <Todos
      input={input}
      todos={todos}
      onChangeInput={onChangeInput}
      onInsert={onInsert}
      onToggle={onToggle}
      onRemove={onRemove}
    />
  );
};

export default TodosContainer;
```

### 17.7.5 useActions ìœ í‹¸ Hookì„ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ê¸°

ì—¬ëŸ¬ ê°œì˜ ì•¡ì…˜ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš° ì½”ë“œê°€ í›¨ì”¬ ê¹”ë”í•´ìš”~ 

```jsx
import { bindActionCreators } from 'redux';
import { useDispatch } from 'react-redux';
import { useMemo } from 'react';

export default function useActions(actions, deps) {
  const dispatch = useDispatch();
  return useMemo(
    () => {
      if (Array.isArray(actions)) {
        return actions.map(a => bindActionCreators(a, dispatch));
      }
      return bindActionCreators(actions, dispatch);
    },
    deps ? [dispatch, ...deps] : deps
  );
}
```

***useActions***

- ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°: ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ ë°°ì—´
- ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°: deps ë°°ì—´
- ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ â†’ ì•¡ì…˜ì„ ë””ìŠ¤íŒ¨ì¹˜í•˜ëŠ” í•¨ìˆ˜ë¡œ ë³€í™˜!
1. ì•¡ì…˜ ìƒì„± í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•¡ì…˜ ê°ì²´ ìƒì„±
2. ì•¡ì…˜ ê°ì²´ë¥¼ ìŠ¤í† ì–´ì— ë””ìŠ¤íŒ¨ì¹˜í•˜ëŠ” ì‘ì—…ì„ í•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

```jsx
import React from 'react';
import { useSelector } from 'react-redux';
import { changeInput, insert, toggle, remove } from '../modules/todos';
import Todos from '../components/Todos';
import useActions from '../lib/useActions';

const TodosContainer = () => {
  const { input, todos } = useSelector(({ todos }) => ({
    input: todos.input,
    todos: todos.todos
  }));

  const [onChangeInput, onInsert, onToggle, onRemove] = useActions(
    [changeInput, insert, toggle, remove],
    []
  );
  return (
    <Todos
      input={input}
      todos={todos}
      onChangeInput={onChangeInput}
      onInsert={onInsert}
      onToggle={onToggle}
      onRemove={onRemove}
    />
  );
};

export default TodosContainer;
```

### 17.7.6 connect í•¨ìˆ˜ì™€ì˜ ì£¼ìš” ì°¨ì´ì 

***connect*** í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì—ˆì„ ê²½ìš°

**When** í•´ë‹¹ ì»¨í…Œì´ë„ˆì˜ ì»´í¬ë„ŒíŠ¸ì˜ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œ

**If** í•´ë‹¹ ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ì˜ propsê°€ ë°”ë€Œì§€ ì•Šì•˜ë‹¤ë©´

**Do** ë¦¬ë Œë”ë§ì´ ìë™ìœ¼ë¡œ ë°©ì§€ë˜ì–´ ì„±ëŠ¥ì´ ìµœì í™”ëœë‹¤.

***useSelector***ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ë•ìŠ¤ ìƒíƒœë¥¼ ì¡°íšŒí–ˆì„ ê²½ìš°

- ìµœì í™” ì‘ì—… ìë™ X
- ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ React.memoë¥¼ í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ì— ì‚¬ìš©í•´ì£¼ê¸°

```jsx
import React from 'react';
import { useSelector } from 'react-redux';
import { changeInput, insert, toggle, remove } from '../modules/todos';
import Todos from '../components/Todos';
import useActions from '../lib/useActions';

const TodosContainer = () => {
  (...)
};

export default React.memo(TodosContainer);
```

## **17.8Â ì •ë¦¬**

**If**  ë¦¬ì•¡íŠ¸ í”„ë¡œì íŠ¸ì—ì„œ ë¦¬ë•ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´

**Do** ì—…ë°ì´íŠ¸ì— ê´€ë ¨ëœ ë¡œì§ì„ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì™„ë²½í•˜ê²Œ ë¶„ë¦¬ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

â†’ ìœ ì§€ ë³´ìˆ˜ì„±ì´ ë†’ì€ ì½”ë“œë¥¼ ì‘ì„±í•´ ë‚¼ ìˆ˜ ìˆë‹¤.