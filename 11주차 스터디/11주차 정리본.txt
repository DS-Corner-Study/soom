# 11ì£¼ì°¨ ìŠ¤í„°ë””

# 7ì¥ useReducerì™€ ìƒíƒœ ê´€ë¦¬

## useReducer ì´í•´í•˜ê¸°

ë¦¬ì•¡íŠ¸ í›… useReducerë¥¼ ì´ìš©í•˜ë©´ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìƒíƒœ ë³€í™” ì½”ë“œë¥¼ ì‰½ê²Œ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.

```jsx
import { useState } from "react";

function TestComp() {
  const [count, setCount] = useState(0);
  const onIncrease = () => {
    setCount(count + 1);
  };
  const onDecrease = () => {
    setCount(count - 1);
  };
  return (
    <div>
      <h4>í…ŒìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸</h4>
      <div>
        <bold>{count}</bold>
      </div>
      <div>
        <button onClick={onIncrease}>+</button>
        <button onClick={onDecrease}>-</button>
      </div>
    </div>
  );
}
export default TestComp;
```

### ìƒíƒœ ë³€í™” ì½”ë“œë€?

State ê°’ì„ ë³€ê²½í•˜ëŠ” ì½”ë“œ

ìƒíƒœ ë³€í™” ì½”ë“œë¥¼ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶„ë¦¬í•œë‹¤

â‡’ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ì‘ì„±í–ˆë˜ ìƒíƒœ ë³€í™” ì½”ë“œë¥¼ ì™¸ë¶€ì— ì‘ì„±í•œë‹¤.

ì´ìœ ? í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ ì•ˆì— ë§ì€ ìƒíƒœ ë³€í™” ì½”ë“œê°€ ìˆë‹¤ë©´ ê°€ë…ì„± Bad

### useReducerì˜ ê¸°ë³¸ ì‚¬ìš©ë²•

```jsx
import { useState } from "react"; 
/* useReducerë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ react ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤ */

function reducer(state, action) {
  switch (action.type) {
    case "INCREASE":
      return state + action.data;
    case "DECREASE":
      return state - action.data;
    case "INIT":
      return 0;
    default:
      return state;
  }
} /* ì»´í¬ë„ŒíŠ¸ ë°–ì— ìƒì„± í•˜ê¸°*/

function TestComp() {
  const [count, dispatch] = useReducer(reduer, 0);

<button onClick={() => dispatch({ type: "INCREASE", data: 1 })}>
+
</button>
<button onClick={() => dispatch({ type: "DECREASE", data: 1 })}>
-
</button>
<button onClick={() => dispatch({ type: "INIT" })}>0ìœ¼ë¡œ ì´ˆê¸°í™”</button>
```

const [ state ë³€ìˆ˜, ìƒíƒœ ë³€í™” ì´‰ë°œ í•¨ìˆ˜ ] = ìƒì„±ì í•¨ìˆ˜ ( ìƒíƒœ ë³€í™” í•¨ìˆ˜, ì´ˆê¸°ê°’);

action ê°ì²´? Stateì˜ ë³€ê²½ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´

## [í•  ì¼ ê´€ë¦¬] ì•± ì—…ê·¸ë ˆì´ë“œ

### useStateë¥¼ useReducerë¡œ ë°”ê¾¸ê¸°

```jsx
import { useReducer, useRef } from "react";

function reducer(State, action) {
  return State;
}

function App() {
  const [todo, dispatch] = useReducer(reducer, mockTodo);
  const idRef = useRef(3);

  const onCreate = (content) => {
    idRef.current += 1;
  };
  const onUpdate = (targetId) => {};
  const onDelete = (targetId) => {};
```

### Create: í•  ì¼ ì•„ì´í…œ ì¶”ê°€í•˜ê¸°

```jsx
function reducer(State, action) {
  switch (action.type) {
    case "CREATE": {
      return [action.newItem, ...state];
    }
    default:
      return state;
  }
}

const onCreate = (content) => {
    dispatch({
      type: "CREATE",
      newItem: {
        id: id.Ref.current,
        content,
        isDone: false,
        createDate: new Date().getTime(),
      },
    });
    idRef.current += 1;
  };
```

### Update: í•  ì¼ ì•„ì´í…œ ìˆ˜ì •í•˜ê¸°

```jsx
function reducer(State, action) {
  switch (action.type) {
    case "CREATE": {
      return [action.newItem, ...state];
    }
    case "UPDATE": {
      return state.map((it) =>
        it.id === action.targetId
          ? {
              ...it,
              isDine: !it.isDone,
            }
          : it
      );
    }
    default:
      return state;
  }
}

const onUpdate = (targetId) => {
    dispatch({
      type: "UPDATE",
      targetId,
    });
  };
```

### Delete: í•  ì¼ ì‚­ì œ êµ¬í˜„í•˜ê¸°

```jsx
function reducer(State, action) {
  switch (action.type) {
    case "CREATE": {
      return [action.newItem, ...state];
    }
    case "UPDATE": {
      return state.map((it) =>
        it.id === action.targetId
          ? {
              ...it,
              isDine: !it.isDone,
            }
          : it
      );
    }
    case "DELETE": {
      return state.filter((it) => it.id !== action.targetId);
    }
    default:
      return state;
  }
}

const onDelete = (targetId) => {
    dispatch({
      type: "DELETE",
      targetId,
    });
  };
```

# 8ì¥ ìµœì í™”

## ìµœì í™”ì™€ ë©”ëª¨ì´ì œì´ì…˜

ìµœì í™”ë€?

- ì›¹ ì„œë¹„ìŠ¤ì˜ ì„±ëŠ¥ì„ ê°œì„ í•˜ëŠ” ê¸°ìˆ 
- í”„ë¡œê·¸ë˜ë°ì—ì„œ ë¶ˆí•„ìš”í•˜ê²Œ ë‚­ë¹„ë˜ëŠ” ì—°ì‚°ì„ ì¤„ì—¬ ë Œë”ë§ì˜ ì„±ëŠ¥ì„ ë†’ì´ëŠ” ë°©ë²•

ë©”ëª¨ì´ì œì´ì…˜ì´ë€ (Memoization)?

- ë©”ëª¨í•˜ëŠ” ë°©ë²•
- ë™ì  ê³„íšë²• (Dynamic Programming, DP)
- íŠ¹ì • ì…ë ¥ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ê³„ì‚°í•´ ë©”ëª¨ë¦¬ ì–´ë”˜ê°€ì— ì €ì¥í–ˆë‹¤ê°€, ë™ì¼í•œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì €ì¥í•œ ê²°ê³¼ê°’ì„ ì œê³µí•˜ì—¬ ë¹ ë¥´ê²Œ ì‘ë‹µí•˜ëŠ” ê¸°ìˆ 

## í•¨ìˆ˜ì˜ ë¶ˆí•„ìš”í•œ ì¬í˜¸ì¶œ ë°©ì§€í•˜ê¸°

useMemoë€? ë©”ëª¨ì´ì œì´ì…˜ ê¸°ë²•ì„ ì´ìš©í•´ ì—°ì‚°ì˜ ê²°ê³¼ê°’ì„ ê¸°ì–µí–ˆë‹¤ê°€ í•„ìš”í•  ë•Œ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë¶ˆí•„ìš”í•œ í•¨ìˆ˜ í˜¸ì¶œì„ ë§‰ì•„ ì£¼ëŠ” ë¦¬ì•¡íŠ¸ í›…

### í•  ì¼ ë¶„ì„ ê¸°ëŠ¥ ì¶”ê°€í•˜ê¸°

```jsx
const analyzeTodo = () => {
    const totalCount = todo.length;
    const doneCount = todo.filter((it) => it.isDone).length;
    const notDoneCount = totalCount - doneCount;
    return {
      totalCount,
      doneCount,
      notDoneCount,
    };
  };
  const { totalCount, doneCount, notDoneCount } = analyzeTodo();

<div>
  <div>í ê°œìˆ˜: {totalCount}</div>
  <div>ì™„ë£Œëœ í•  ì¼: {doneCount}</div>
	<div>ì•„ì§ ì™„ë£Œí•˜ì§€ ëª» í•œ í•  ì¼: {notDoneCount}</div>
</div>
```

### ë¬¸ì œì  íŒŒì•…í•˜ê¸°

ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì„ ì–¸í•œ í•¨ìˆ˜ëŠ” ë Œë”ë§í•  ë•Œë§ˆë‹¤ ì‹¤í–‰ëœë‹¤.

### useMemoë¥¼ ì´ìš©í•´ [í•  ì¼ ê´€ë¦¬] ì•± ìµœì í™”í•˜ê¸°

[useMemoì˜ ìš©ë²•]

const value = useMemo( ì½œë°± í•¨ìˆ˜, ì˜ì¡´ì„± ë°°ì—´ );

```jsx
import { useStat, useMemo } from "react";
const analyzeTodo = useMemo(() => {
    console.log("analyzeTodo í•¨ìˆ˜ í˜¸ì¶œ");
    const totalCount = todo.length;
    const doneCount = todo.filter((it) => it.isDone).length;
    const notDoneCount = totalCount - doneCount;
    return {
      totalCount,
      doneCount,
      notDoneCount,
    };
  }, [todo]);
  const { totalCount, doneCount, notDoneCount } = analyzeTodo;
```

## ë¶ˆí•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë” ë°©ì§€í•˜ê¸°

### ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ì™€ íš¡ë‹¨ ê´€ì‹¬ì‚¬

ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ë€? (HOC, Higher Order Component)

- ì»´í¬ë„ŒíŠ¸ì˜ ê¸°ëŠ¥ì„ ë‹¤ì‹œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë¦¬ì•¡íŠ¸ì˜ ê³ ê¸‰ê¸°ìˆ 
- ì¸ìˆ˜ë¡œ ì „ë¨ëœ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜

ex) const EnhancedComp = withFunc(Comp);

ë˜í•‘ëœ ì»´í¬ë„ŒíŠ¸: ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ì— ì¸ìˆ˜ë¡œ ì „ë‹¬ëœ ì»´í¬ë„ŒíŠ¸

ê°•í™”ëœ ì»´í¬ë„ŒíŠ¸: ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ê°€ ë°˜í™˜í•˜ëŠ” ì»´í¬ë„ŒíŠ¸

íš¡ë‹¨ ê´€ì‹¬ì‚¬ë€? (Cross-Cutting Concerns)

- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ êµ¬ë¶„ë˜ëŠ” ê³µí†µ ê¸°ëŠ¥
- ë¡œê¹…, ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì†, ì¸ê°€ ë“± ì—¬ëŸ¬ ê³³ì—ì„œ í˜¸ì¶œí•´ ì‚¬ìš©í•˜ëŠ” ì½”ë“œ

### React.memoë¥¼ ì´ìš©í•´ [í•  ì¼ ê´€ë¦¬] ì•± ìµœì í™”í•˜ê¸°

React.memoë€? ì»´í¬ë„ŒíŠ¸ê°€ ëª¨ë“  ìƒí™©ì—ì„œ ë¦¬ë Œë”ë˜ì§€ ì•Šë„ë¡ ê°•í™”í•¨ìœ¼ë¡œì¨ ì„œë¹„ìŠ¤ë¥¼ ìµœì í™”í•˜ëŠ” ë„êµ¬

ì‚¬ìš©ë²•? ê°•í™”í•˜ê³  ì‹¶ì€, ì¦‰ ë©”ëª¨ì´ì œì´ì…˜ì„ ì ìš©í•˜ê³  ì‹¶ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ React.memoë¡œ ê°ì‹¸ë©´ ëœë‹¤.

[React.memoì˜ ìš©ë²•]

const memoizedComp = React.memo( ë©”ëª¨ì´ì œì´ì…˜í•˜ë ¤ëŠ” ì»´í¬ë„ŒíŠ¸ );

```jsx
import React from "react";
const Header = () => {
  console.log("Header ì—…ë°ì´íŠ¸");
  return (
    <div className="Header">
      <h3>ì˜¤ëŠ˜ì€ ğŸ“…</h3>
      <h1>{new Date().toDateString()}</h1>
    </div>
  );
};
export default React.memo(Header);
/* Header.jsì—ì„œ Header ì»´í¬ë„ŒíŠ¸ì— ë©”ëª¨ì´ì œì´ì…˜ì„ ì ìš©í•´ ë‚´ë³´ë‚¸ë‹¤ */
```

```jsx
import React from "react";

const TodoItem = ({ id, content, isDone, createdDate, onUpdate, onDelete }) => {
  console.log(`${id} TodoItem ì—…ë°ì´íŠ¸`);

export default React.memo(TodoItem);
```

## ë¶ˆí•„ìš”í•œ í•¨ìˆ˜ ì¬ìƒì„± ë°©ì§€í•˜ê¸°

useCallbackì´ë€? ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë  ë•Œ ë‚´ë¶€ì— ì‘ì„±ëœ í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ì§€ ì•Šë„ë¡ ë©”ëª¨ì´ì œì´ì…˜í•˜ëŠ” ë¦¬ì•¡íŠ¸ í›…

### useCallbackì„ ì´ìš©í•´ [í•  ì¼ ê´€ë¦¬] ì•± ìµœì í™”í•˜ê¸°

[useCallbackì˜ ìš©ë²•]

const memoizedFunc = useCallback( ì½œë°± í•¨ìˆ˜, ì˜ì¡´ì„± ë°°ì—´ )

ì²« ë²ˆì§¸ ì¸ìˆ˜ë¡œ ì „ë‹¬í•œ ì½œë°± í•¨ìˆ˜ë¥¼ ì–´ë–¤ ê²½ìš°ì—ë„ ë‹¤ì‹œ ìƒì„±ë˜ì§€ ì•Šê²Œ í•˜ë ¤ë©´?

consto memoizedFunc = useCallback( func, [] )

```jsx
import { useReducer, useRef, useCallback } from "react";

const onUpdate = useCallback((targetId) => {
    dispatch({
      type: "UPDATE",
      targetId,
    });
  }, []);
  const onDelete = useCallback((targetId) => {
    dispatch({
      type: "DELETE",
      targetId,
    });
  }, []);
```

### ìµœì í™”í•  ë•Œ ìœ ì˜í•  ì 

1. ìµœì í™”ëŠ” í•­ìƒ ë§ˆì§€ë§‰ì— í•˜ê¸°! í”„ë¡œì íŠ¸ ê°œë°œì´ ëë‚˜ê³  ë§ˆì§€ë§‰ì— ì§„í–‰í•˜ì„¸ìš”
2. ëª¨ë“  ê²ƒì„ ìµœì í™”í•  í•„ìš”ëŠ” ì—†ë‹¤! ë¶€í•˜ê°€ ë§ë‹¤ê³  ì˜ˆìƒë˜ëŠ” ê²ƒ, ë³µì¡í•œ ì—°ì‚° ìˆ˜í–‰, ë°˜ë³µì ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ê°€ ë‚˜íƒ€ë‹¤ëŠ” ê²ƒ ë“±ì„ ëŒ€ìƒìœ¼ë¡œ ì§„í–‰ëœë‹¤
3. ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°ë¥¼ ì˜ ì„¤ê³„í–ˆëŠ”ì§€ ê²€í† í•˜ê¸°! ê¸°ëŠ¥ or ì—­í•  ë‹¨ìœ„ë¡œ ì˜ ë¶„ë¦¬í–ˆëŠ”ì§€ í™•ì¸ í›„ ìµœì í™”í•˜ê¸°
4. ìµœì í™”ëŠ” ì—¬ê¸°ì„œ ëì´ ì•„ë‹™ë‹ˆë‹¤ ë¿…!